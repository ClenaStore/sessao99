<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>SESS√ÉO 99</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{margin:0;background:#05070f;color:#fff;font-family:Inter}
header{
  position:fixed;top:0;width:100%;z-index:10;
  padding:16px 40px;
  display:flex;justify-content:space-between;
  background:rgba(0,0,0,.8)
}
main{margin-top:90px;padding:40px}
.row{display:flex;gap:16px;overflow-x:auto}
.card{min-width:220px;height:330px;border-radius:12px;overflow:hidden;cursor:pointer}
.card img{width:100%;height:100%;object-fit:cover}
.debug{color:#22c55e;margin-bottom:20px}
.error{color:#ef4444}
</style>
</head>
<body>

<header>
  <h2>üé¨ SESS√ÉO 99</h2>
  <input id="search" placeholder="Buscar...">
</header>

<main>
  <div id="debug" class="debug">Carregando...</div>
  <div id="content"></div>
</main>

<script>
const supabase = supabaseJs.createClient(
  "https://dxkszikemntfusfyrzos.supabase.co",
  "sb_publishable_NNFvdfSXgOdGGVcSbphbjQ_brC3_9ed"
);

const debug=document.getElementById("debug");
const content=document.getElementById("content");

async function carregar(){
  const {data,error} = await supabase
    .from("filmes")
    .select("*")
    .eq("ativo",true);

  if(error){
    debug.innerHTML = "‚ùå ERRO SUPABASE:<br>"+JSON.stringify(error,null,2);
    debug.className="error";
    return;
  }

  debug.innerText = `‚úÖ ${data.length} filme(s) carregado(s)`;
  render(data);
}

function render(lista){
  content.innerHTML="";
  const categorias=[...new Set(lista.map(f=>f.categoria||"Outros"))];

  categorias.forEach(cat=>{
    const h=document.createElement("h3");
    h.innerText=cat;
    const row=document.createElement("div");
    row.className="row";

    lista.filter(f=>(f.categoria||"Outros")==cat).forEach(f=>{
      if(!f.capa_url) return;
      const c=document.createElement("div");
      c.className="card";
      c.innerHTML=`<img src="${f.capa_url}">`;
      c.onclick=()=>window.open(f.video_url,"_blank");
      row.appendChild(c);
    });

    content.appendChild(h);
    content.appendChild(row);
  });
}

carregar();
</script>
</body>
</html>
